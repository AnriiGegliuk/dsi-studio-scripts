# data base agregation logic based on conditions